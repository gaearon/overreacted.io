engine: nixery
when:
  - event: ["push", "pull_request"]
    branch: ["main"]

dependencies:
  nixpkgs:
    - nodejs

steps:
  - name: build site
    command: |
      nix develop --command bash -c 'npm run build'
  - name: deploy
    command: |
      npx --yes wrangler pages deploy --branch main --project-name overreacted ./out/
