---
title: 'npm audit: è¨­è¨ˆã‹ã‚‰ç ´ç¶»ã—ã¦ã„ã¾ã™'
date: '2021-07-07'
spoiler: "99 ä»¶ã®è„†å¼±æ€§ã‚’ç™ºè¦‹ã—ã¾ã—ãŸ (84 ä»¶ã¯ä¸­ç¨‹åº¦ã«ç„¡é–¢ä¿‚ã€15 ä»¶ã¯é«˜ç¨‹åº¦ã«ç„¡é–¢ä¿‚ã§ã™)"
---

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯å¤§äº‹ã§ã™ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒæ‚ªåŒ–ã™ã‚‹ã‚ˆã†ãªã“ã¨ã‚’ã‚ã–ã‚ã–æ“è­·ã—ãŸã„äººã¯èª°ã‚‚ã„ã¾ã›ã‚“ã€‚ã ã‹ã‚‰ä»Šã‹ã‚‰æ›¸ãã“ã¨ã‚‚ã€èª°ã‚‚è¨€ã„ãŸããªã„ã“ã¨ã§ã™ã€‚ã—ã‹ã—ã€èª°ã‹ãŒè¨€ã‚ã­ã°ãªã‚Šã¾ã›ã‚“ã€‚

ãã†ã„ã†ã‚ã‘ã§ã€ç§ãŒè¨€ã„ã¾ã™ã€‚

**`npm audit` ã¯æŒ™å‹•ãŒç ´ç¶»ã—ã¦ã„ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ `npm install` ã®åº¦ã«å‡ºã¦ãã¾ã™ãŒã€å¤§é‡ã«æŠ¼ã—å¯„ã›ã¦ãã‚‹å‰²ã«ã¯è€ƒæ…®ä¸è¶³ã®å†…å®¹ã§ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ååˆ†ãªæ°´æº–ã«ã‚ã‚‹ã¨ã¯è¨€ãˆã¾ã›ã‚“ã€‚**

[ã‚ªã‚ªã‚«ãƒŸå°‘å¹´](https://ja.wikipedia.org/wiki/%E5%98%98%E3%82%92%E3%81%A4%E3%81%8F%E5%AD%90%E4%BE%9B)ã®ãŠè©±ã‚’èã„ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿãƒã‚¿ãƒãƒ©ã‚·ã‚’ã™ã‚‹ã¨ç¾Šã¯ã¿ã‚“ãªç‹¼ã«é£Ÿã¹ã‚‰ã‚Œã¦ã—ã¾ã†ã®ã§ã™ãŒã€æˆ‘ã€…ã‚‚ç¾Šã‚’é£Ÿã¹ã‚‰ã‚ŒãŸããªã‘ã‚Œã°ã‚‚ã£ã¨ãƒã‚·ãªãƒ„ãƒ¼ãƒ«ã‚’æŒã¤ã¹ãã§ã™ã€‚

ä»Šæ—¥ã§ã¯ `npm audit` ã¯ npm ã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®æ±šç‚¹ã«ãªã£ã¦ã„ã¾ã™ã€‚ã“ã‚ŒãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æŒ™å‹•ã¨ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã‚‹æ™‚ã«ä½•ã¨ã‹ã—ã¦ã„ã‚Œã°ä¸€ç•ªè‰¯ã‹ã£ãŸã®ã§ã™ãŒã€ä»Šã‹ã‚‰ã§ã‚‚é…ãã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ã“ã®è¨˜äº‹ã§ã¯ `npm audit` ã®æŒ™å‹•ã‚’èª¬æ˜ã—ã€ãªãœã“ã‚ŒãŒå£Šã‚Œã¦ã„ã‚‹ã®ã‹ã€ã©ã†å¤‰ã‚ã£ã¦ã„ã‚‹ã¨ã†ã‚Œã—ã„ã®ã‹ã‚’æ¦‚ç•¥ã—ã¾ã™ã€‚

---

*æ³¨æ„: ã“ã®è¨˜äº‹ã¯æ‰¹åˆ¤ã‚’å«ã‚“ã§ãŠã‚Šã€ã¾ãŸå­å‘³ã£ãŸã‚‰ã—ã„æ–‡ä½“ã§æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚ã‚‚ã¡ã‚ã‚“ Node.js ã‚„ npm ã®ã‚ˆã†ãªå·¨å¤§ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã™ã‚‹ã“ã¨ã¯å¤§å¤‰ãªè‹¦åŠ´ã§ã‚ã‚‹ã¨ç†è§£ã—ã¦ã¾ã™ã—ã€é–“é•ã„ãŒæ˜ã‚‰ã‹ã«ãªã‚‹ã®ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã®ã‚‚åˆ†ã‹ã‚Šã¾ã™ã€‚ç§ã¯ã“ã®çŠ¶æ³ã«å¯¾ã—ã¦ãƒ•ãƒ©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ„Ÿã˜ã¦ã„ã‚‹ã®ã§ã‚ã£ã¦ã€é–¢ã‚ã£ãŸäººã€…ã«ä½•ã‹ã‚’è¨€ã†ã¤ã‚‚ã‚Šã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãã‚Œã§ã‚‚ã“ã†ã„ã†æ›¸ãæ–¹ã‚’ã—ã¦ã„ã‚‹ã®ã¯å½“ã®ãƒ•ãƒ©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¹´ã€…æ‚ªåŒ–ã—ã¦ãŠã‚Šã€ã“ã®æ‚²æƒ¨ãªçŠ¶æ³ã‚’å®Ÿéš›ã‚ˆã‚Šã‚‚å°ã•ãè¦‹ã›ã‚‹ã‚ˆã†ãªãƒãƒã¯ã—ãŸããªã‹ã£ãŸã‹ã‚‰ã§ã™ã€‚ç§ãŒç‰¹ã«è¦‹ã¦ã„ã¦è¾›ã„ã¨æ„Ÿã˜ã‚‹ã®ã¯ã“ã‚ŒãŒåˆã‚ã¦ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ä½“é¨“ã«ãªã£ãŸäººã€…ã€åŠ ãˆã¦ã¾ã£ãŸãç„¡é–¢ä¿‚ã®è­¦å‘Šã®ã›ã„ã§ã›ã£ã‹ãã®å¤‰æ›´ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã§ããªããªã£ã¦ã—ã¾ã£ãŸäººã€…ã€ã¿ã‚“ãªã§ã™ã€‚ã†ã‚Œã—ã„ã“ã¨ã«ã€[ã“ã®å•é¡Œã«ã¤ã„ã¦æ¤œè¨ã—ã¦ãã‚Œã‚‹äººãŒç¾ã‚Œã¦ã„ã¾ã™](https://twitter.com/bitandbang/status/141280337827975987)ã€‚è§£æ±ºç­–ãŒã‚ãŒã£ãŸéš›ã«ã¯ç§ã‚‚ã§ãã‚‹ã ã‘æƒ…å ±æä¾›ã‚’ã—ã¦ã„ããŸã„ã¨æ€ã£ã¦ã„ã¾ã™ ğŸ’œ*

---

## npm audit ã®æŒ™å‹•ã«ã¤ã„ã¦

*è©³ã—ã„æŒ™å‹•ã«ã¤ã„ã¦ã™ã§ã«ã”å­˜çŸ¥ã®äººã¯[èª­ã¿é£›ã°ã—ã¦ã‚‚ã‚‰ã£ã¦æ§‹ã„ã¾ã›ã‚“](#ãªãœ-npm-audit-ã¯ç ´ç¶»ã—ã¦ã„ã‚‹ã®ã‹)ã€‚*

ã‚ãªãŸã® Node.js ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¾å­˜ãƒ„ãƒªãƒ¼ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ã“ã‚“ãªæ„Ÿã˜ã«è¦‹ãˆã‚‹ã¯ãšã§ã™ã€‚

```
your-app
  - view-library@1.0.0
  - design-system@1.0.0
  - model-layer@1.0.0
    - database-layer@1.0.0
      - network-utility@1.0.0
```

å¤§æŠµã®å ´åˆã€ã“ã®ãƒ„ãƒªãƒ¼ã¯ã‚‚ã£ã¨ãšã£ã¨æ·±ã„ã¯ãšã§ã™ã€‚

ã“ã“ã§ã€ãŸã¨ãˆã° `network-utility@1.0.0` ã«è„†å¼±æ€§ãŒè¦‹ã¤ã‹ã£ãŸã¨è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```
your-app
  - view-library@1.0.0
  - design-system@1.0.0
  - model-layer@1.0.0
    - database-layer@1.0.0
      - network-utility@1.0.0 (è„†å¼±æ€§ã‚ã‚Š!)
```

ã“ã‚Œã¯ç‰¹åˆ¥ãªãƒ¬ã‚¸ã‚¹ãƒˆãƒªã« publish ã•ã‚Œã¦ãŠã‚Šã€ã“ã®å¾Œ `npm audit` ã‚’å®Ÿè¡Œã—ãŸã¨ãã« `npm` ã¯ãã“ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚npm v6+ ä»¥é™ã§ã¯ã€`npm install` ã®ãŸã³ã«ã“ã®ã“ã¨ã‚’æ•™ãˆã¦ãã‚Œã¾ã™ã€‚

```
1 vulnerabilities (0 moderate, 1 high)

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force
```

ã‚ãªãŸãŒ `npm audit fix` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€npm ã¯ä¿®æ­£ã®å…¥ã£ãŸæœ€æ–°ç‰ˆã® `network-utility@1.0.1` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã«è¡Œãã¾ã™ã€‚ã‚‚ã— `database-layer` ãŒ `network-utility@1.0.0` ã‚’*å®Œå…¨ä¸€è‡´ã§*ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®šã—ã¦ã„ã‚‹ã¨ã‹ã§ãªã„é™ã‚Šã€ã¤ã¾ã‚Š `1.0.1` ã‚’å«ã‚€ã‚ˆã†ãªå¹…ã‚’æŒã£ãŸæŒ‡å®šã‚’ã—ã¦ã„ã‚‹é™ã‚Šã€ã“ã®ä¿®æ­£ã¯ã€Œãã®ã¾ã¾å‹•ãã€ã¯ãšã§ã™ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯å£Šã‚Œã¾ã›ã‚“ã€‚

```
your-app
  - view-library@1.0.0
  - design-system@1.0.0
  - model-layer@1.0.0
    - database-layer@1.0.0
      - network-utility@1.0.1 (ä¿®æ­£æ¸ˆï¼)
```

ä¸‡ãŒä¸€ã€`database-layer@1.0.0` ãŒå®Œå…¨ä¸€è‡´ã§ `network-utility@1.0.0` ã«ä¾å­˜ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãã†ã„ã†ã¨ãã¯ `database-layer` ã®ãƒ¡ãƒ³ãƒ†ãƒŠã‚‚æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã€`network-utility@1.0.1` ã‚’è¨±å®¹ã™ã‚‹å½¢ã§ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```
your-app
  - view-library@1.0.0
  - design-system@1.0.0
  - model-layer@1.0.0
    - database-layer@1.0.1 (ä¿®æ­£ã§ãã‚‹ã‚ˆã†ã«ã“ã¡ã‚‰ã‚‚ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ)
      - network-utility@1.0.1 (ä¿®æ­£æ¸ˆ!)
```

ãƒ„ãƒªãƒ¼ã‚’ãã‚Œã„ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹æ–¹æ³•ãŒãªã„å ´åˆã¯ã€æœ€çµ‚æ‰‹æ®µã¨ã—ã¦ `npm audit fix --force` ã‚’ä½¿ãˆã¾ã™ã€‚ã“ã®æ–¹æ³•ã‚’æ¡ã‚Œã‚‹ã®ã¯ `database-layer` ãŒæ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® `network-utility` ã‚’è¨±å®¹ã—ã¦ãŠã‚‰ãšã€_ãã®ä¸Š_ æ–°ã—ã„ãƒªãƒªãƒ¼ã‚¹ã‚‚ã—ã¦ãã‚Œã¦ãªã„ã¨ã„ã†çŠ¶æ³ã®ã¨ãã§ã™ã€‚ã“ã‚Œã¯ breaking changes ã®ãƒªã‚¹ã‚¯ã‚’æ‰¿çŸ¥ã®ä¸Šã§ã€è‡ªå·±è²¬ä»»ã§ã“ã®å•é¡Œã‚’å¼•ãå—ã‘ã‚ˆã†ã¨ã„ã†åˆ¤æ–­ã«å½“ãŸã‚Šã¾ã™ã€‚ãã†ã„ã†é¸æŠè‚¢è‡ªä½“ã¯ã‚ã£ã¦ã—ã‹ã‚‹ã¹ãã§ã—ã‚‡ã†ã€‚

**ã“ã‚ŒãŒ `npm audit` ã®ç†è«–ä¸Šã®æŒ™å‹•ã§ã™ã€‚**

è³¢ã„äººãŒè¨€ã£ã¦ãŸé€šã‚Šã€ç†è«–ä¸Šã¯ç†è«–ã¨å®Ÿè·µã®é–“ã«é•ã„ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãŒã€å®Ÿè·µä¸Šã¯ã‚ã‚‹ã‚ã‘ã§ã™ã€‚æ¥½ã—ã„è©±ã¯ã“ã“ã‹ã‚‰ã§ã™ã€‚

## ãªãœ npm audit ã¯ç ´ç¶»ã—ã¦ã„ã‚‹ã®ã‹

ã§ã¯ã€å®Ÿè·µã«ãŠã„ã¦ `npm audit` ãŒã©ã†å‹•ãã®ã‹ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚å®Ÿé¨“ã«ã¯ Create React App ã‚’ä½¿ã„ã¾ã™ã€‚

è©³ã—ããªã„äººå‘ã‘ã«èª¬æ˜ã™ã‚‹ã¨ã€ã“ã‚Œã¯è¤‡æ•°ã®ãƒ„ãƒ¼ãƒ«ã‚’ã¤ãªãåˆã‚ã›ãŸçµ±åˆçš„ãªçª“å£ã§ã™ã€‚Babelã€webpackã€TypeScriptã€ESLintã€PostCSSã€Terserâ€¦â€¦ ãªã©ã‚’å«ã¿ã¾ã™ã€‚Create React App ã¯ã‚ãªãŸã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰é™çš„ãª HTML+JS+CSS ã®å…¥ã£ãŸãƒ•ã‚©ãƒ«ãƒ€ã«å¤‰æ›ã—ã¾ã™ã€‚**å¤§åˆ‡ãªã®ã¯ã€ã“ã“ã§ã¯ Node.js ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä½œã‚‰ã‚Œãªã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚**

æ–°è¦ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼

```
npx create-react-app myapp
```

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã¨ç›´å¾Œã«ã“ã‚“ãªã‚‚ã®ãŒè¦‹ãˆã¾ã™ã€‚

```
found 5 vulnerabilities (3 moderate, 2 high)
  run `npm audit fix` to fix them, or `npm audit` for details
```

ãªã‚“ã¨ã€ãƒã‚ºãã†ãªã“ã¨ãŒèµ·ã“ã‚Šã¾ã—ãŸï¼ãŸã£ãŸä»Šã¤ãã£ãŸã°ã‹ã‚Šã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚‚ã†è„†å¼±æ€§ã‚’å«ã‚“ã§ã„ã¾ã™ï¼

å°‘ãªãã¨ã‚‚ npm ã¯ãã†è¨€ã£ã¦ã¾ã™ã—â€¦â€¦ã€‚

`npm audit` ã‚’å®Ÿè¡Œã—ã¦ä½•ãŒèµ·ãã¦ã„ã‚‹ã‹ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### ç¬¬ä¸€ã®ã€Œè„†å¼±æ€§ã€

ã“ã‚Œã¯ `npm audit` ãŒå ±å‘Šã—ã¦ããŸ1ã¤ç›®ã®å•é¡Œç‚¹ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Moderate      â”‚ Regular Expression Denial of Service                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Package       â”‚ browserslist                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Patched in    â”‚ >=4.16.5                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dependency of â”‚ react-scripts                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Path          â”‚ react-scripts > react-dev-utils > browserslist               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ More info     â”‚ https://npmjs.com/advisories/1747                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¦‹ã¦ã®é€šã‚Šã€`browserslist` ã«è„†å¼±æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã©ã†ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã€ã©ã†ã‚„ã£ã¦ä½¿ã‚ã‚Œã¦ã„ã‚‹ã®ã§ã—ã‚‡ã†ï¼Ÿ Create React App ã¯ã‚ãªãŸã®å¯¾è±¡ãƒ–ãƒ©ã‚¦ã‚¶ã«å‘ã‘ã¦æœ€é©åŒ–ã•ã‚ŒãŸ CSS ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ãŸã¨ãˆã°ã€ã‚ãªãŸã® `package.json` ã§ã¯ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ã ã‘ã‚’å¯¾è±¡ã«ã™ã‚Œã°è‰¯ã„ã¨ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```jsx
  "browserslist": {
    "production": [
      ">0.2%",
      "not dead",
      "not op_mini all"
    ],
    "development": [
      "last 1 chrome version",
      "last 1 firefox version",
      "last 1 safari version"
    ]
  }
```

ã“ã†ã™ã‚‹ã¨ã€æœ€çµ‚çµæœã«ã¯ flexbox ã§æ˜”å¿…è¦ã ã£ãŸãƒãƒƒã‚¯ãŒå«ã¾ã‚Œãªããªã‚Šã¾ã™ã€‚å¯¾è±¡ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã¯è¤‡æ•°ã®ãƒ„ãƒ¼ãƒ«ã‹ã‚‰åŒã˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ä½¿ã‚ã‚Œã‚‹ã‚‚ã®ãªã®ã§ã€Create React App ã¯ã²ã¨ã¤ã® `browserslist` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã„ã‚‹ã®ã§ã™ã€‚

ã•ã¦ã€ã“ã“ã§ã„ã†è„†å¼±æ€§ã¨ã¯ä½•ã§ã—ã‚‡ã†ã‹ï¼Ÿ [â€œRegular Expression Denial of Serviceâ€](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS) ã¨ã„ã†ã®ã¯ `browserslist` å†…ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹æ­£è¦è¡¨ç¾ãŒã€æ‚ªæ„ã®ã‚ã‚‹å…¥åŠ›ã‚’å—ã‘å–ã£ãŸå ´åˆã«éå¸¸ã«é…ããªã£ã¦ã—ã¾ã†ã¨ã„ã†å•é¡Œã§ã™ã€‚æ”»æ’ƒè€…ãŒç‰¹æ®Šãªè¨­å®šã—ãŸæ­£è¦è¡¨ç¾ã‚’ä½œã‚Šè¾¼ã‚“ã§ `browserlist` ã«æ¸¡ã™ã¨ã€ãã®é€Ÿåº¦ãŒæŒ‡æ•°é–¢æ•°çš„ã«è½ã¡ã¦ã—ã¾ã†ã¨ã„ã†ã“ã¨ã§ã™ã€‚ãªã‚“ã¦ã²ã©ã„â€¦â€¦

ã£ã¦ã„ã‚„ã„ã‚„ã€å¾…ã£ã¦ãã ã•ã„ï¼Ÿã¡ã‚‡ã£ã¨ã“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å‹•ãã‚’æ€ã„å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã‚ãªãŸã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ _è‡ªèº«ã®ãƒã‚·ãƒ³ã«_ æŒã£ã¦ã„ã¦ã€ã‚ãªãŸè‡ªèº«ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ _ãƒ“ãƒ«ãƒ‰ã—ã¦ã„ã¾ã™_ã€‚ã§ãã‚ãŒã‚‹ã®ã¯é™çš„ãª HTML+CSS+JS ã®å…¥ã£ãŸãƒ•ã‚©ãƒ«ãƒ€ã§ã€ã“ã‚Œã¯é™çš„ã«ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚ãªãŸã® `package.json` ã«å½±éŸ¿ã‚’åŠã¼ã™æ–¹æ³•ã¯ã‚·ãƒ³ãƒ—ãƒ«ã«**å­˜åœ¨ã—ã¾ã›ã‚“**ã€‚ **ã¾ã£ãŸãã‚‚ã£ã¦æ„å‘³ãŒã‚ã‹ã‚Šã¾ã›ã‚“ã‚ˆã­ã€‚** ã‚‚ã—æ”»æ’ƒè€…ãŒã‚ãªãŸã®ãƒã‚·ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã„ã˜ã‚Œã‚‹ã®ã ã¨ã—ãŸã‚‰ã€æ­£è¦è¡¨ç¾ãŒé…ã„ã“ã¨ãªã‚“ã‹ã‚ˆã‚Šé¥ã‹ã«ã¾ãšã„å•é¡ŒãŒèµ·ã“ã£ã¦ã„ã‚‹ã¯ãšã§ã™ã‚ˆï¼

ã¯ã„ã€ã¨ã„ã†ã“ã¨ã§ã“ã®ã€Œä¸­ç¨‹åº¦ã®ã€ã€Œè„†å¼±æ€§ã€ã¯ã€ä¸­ç¨‹åº¦ã§ã‚‚ãªã‘ã‚Œã°è„†å¼±æ€§ã§ã‚‚ãªã‹ã£ãŸã‚ã‘ã§ã™ã€‚ã“ã®ã¾ã¾æ”¾ã£ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

**è©•æ±º: æœ¬ä»¶ã«ãŠã‘ã‚‹ã€Œè„†å¼±æ€§ã€ã¨ã¯ã¾ã£ãŸãã°ã‹ã’ãŸã‚‚ã®ã§ã™ã€‚**

### ç¬¬äºŒã®ã€Œè„†å¼±æ€§ã€

æ¬¡ã«è¦‹ãˆã‚‹ã®ã¯ã€`npm audit` ãŒè‰¯ã‹ã‚Œã¨æ€ã£ã¦å ±å‘Šã—ã¦ãã‚ŒãŸã‚‚ã†ä¸€ã¤ã®å•é¡Œç‚¹ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Moderate      â”‚ Regular expression denial of service                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Package       â”‚ glob-parent                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Patched in    â”‚ >=5.1.2                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dependency of â”‚ react-scripts                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Path          â”‚ react-scripts > webpack-dev-server > chokidar > glob-parent  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ More info     â”‚ https://npmjs.com/advisories/1751                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ã§ã¯ `webpack-dev-server > chokidar > glob-parent` ã¨ã„ã†ä¾å­˜é–¢ä¿‚ã®æµã‚Œã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã“ã“ã«å‡ºã¦ãã‚‹ `webpack-dev-server` ã¨ã¯ **é–‹ç™ºç’°å¢ƒã§ã®ã¿ä½¿ç”¨ã™ã‚‹**ã‚µãƒ¼ãƒãƒ¼ã§ã€ã‚ãªãŸã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ **ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§** ç´ é€Ÿãè¡¨ç¤ºã—ã¦ãã‚Œã‚‹ã‚‚ã®ã§ã™ã€‚ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ `chokidar` ã¨ã„ã†ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®å¤‰æ›´ï¼ˆãŸã¨ãˆã°ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒä¿å­˜ã•ã‚ŒãŸã¨ã‹ï¼‰ã‚’ç›£è¦–ã—ã¾ã™ã€‚ã“ã® `chokidar` ã¯ã•ã‚‰ã« [`glob-parent`](https://www.npmjs.com/package/glob-parent) ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æŒ‡å®šã‹ã‚‰ã©ã“ãŒç›£è¦–å¯¾è±¡ã«ãªã‚‹ã‹ã‚’æŠ½å‡ºã—ã¦ã„ã¾ã™ã€‚

æ®‹å¿µãªã“ã¨ã« `glob-parent` ã«ã¯è„†å¼±æ€§ãŒã‚ã‚Šã¾ã—ãŸï¼ã‚‚ã—æ”»æ’ƒè€…ãŒç‰¹æ®Šãªãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ä½œã‚Šè¾¼ã‚“ã§ã„ãŸå ´åˆã€ãã®å®Ÿè¡Œé€Ÿåº¦ã¯æŒ‡æ•°é–¢æ•°çš„ã«é…ããªã£ã¦ã—ã¾ã„ã€ãã®çµæœâ€¦â€¦

ã£ã¦å¾…ã£ã¦ãã ã•ã„ã€‚é–‹ç™ºç”¨ã‚µãƒ¼ãƒãƒ¼ã¨ã„ã†ã®ã¯è‡ªåˆ†ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã«ã‚ã‚‹ã‚‚ã®ã§ã™ã‚ˆã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã ã£ã¦è‡ªåˆ†ã®ã§ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã®ä»•çµ„ã¿ã‚‚ *è‡ªåˆ†è‡ªèº«ã§* æ›¸ã„ãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã“ã«å‡ºã¦ãã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã®ã€ã©ã®éƒ¨åˆ†ã‚‚è‡ªåˆ†ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‹ã‚‰å‡ºã¦ã„ã¾ã›ã‚“ã­ã€‚ã‚‚ã—ã“ã®æ”»æ’ƒè€…ãŒã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§é–‹ç™ºã—ã¦ã„ã‚‹æœ€ä¸­ã®ã‚ãªãŸã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã»ã©ã«å“è¶Šã—ãŸç›¸æ‰‹ã ã¨ã—ãŸã‚‰ã€ç‰¹æ®Šãªé•·ã„ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹åã‚’ä½œã£ã¦é–‹ç™ºé€Ÿåº¦ã‚’è½ã¨ã™ãªã‚“ã¦çœŸä¼¼ã¯ã¨ã¦ã‚‚ã—ãã†ã«ã‚ã‚Šã¾ã›ã‚“ã€‚ãã†ã§ã¯ãªãã€æ©Ÿå¯†æƒ…å ±ã‚’ç›—ã¿ã«ãã‚‹ã¯ãšã§ã™ã€‚**ã“ã®é©šç•°å…¨ä½“ãŒã°ã‹ã’ãŸä»®å®šã¨è¨€ã‚ã–ã‚‹ã‚’å¾—ã¾ã›ã‚“ã€‚**

è¦‹ã‚‹é™ã‚Šã“ã®ã€Œä¸­ç¨‹åº¦ã®ã€ã€Œè„†å¼±æ€§ã€ã¯ã€ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ–‡è„ˆã«ãŠã„ã¦ã¯ä¸­ç¨‹åº¦ã§ã‚‚è„†å¼±æ€§ã§ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚

**è©•æ±º: æœ¬ã€Œè„†å¼±æ€§ã€ã¯ã“ã®æ–‡è„ˆã§ã¯ã°ã‹ã’ãŸã‚‚ã®ã§ã™ã€‚**

### ç¬¬ä¸‰ã®ã€Œè„†å¼±æ€§ã€

ä»Šåº¦ã¯ã“ã£ã¡ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Moderate      â”‚ Regular expression denial of service                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Package       â”‚ glob-parent                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Patched in    â”‚ >=5.1.2                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dependency of â”‚ react-scripts                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Path          â”‚ react-scripts > webpack > watchpack > watchpack-chokidar2 >  â”‚
â”‚               â”‚ chokidar > glob-parent                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ More info     â”‚ https://npmjs.com/advisories/1751                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

å¾…ã£ã¦ãã ã•ã„ã€ä¸Šã¨åŒã˜ã˜ã‚ƒãªã„ã§ã™ã‹ã€‚ä¾å­˜é–¢ä¿‚ã®çµŒè·¯ãŒé•ã†ã¨ã„ã†ã ã‘ã§ã€‚

Wait, itâ€™s the same thing as above, but through a different dependency path.

**è©•æ±º: æœ¬ã€Œè„†å¼±æ€§ã€ã¯ã“ã®æ–‡è„ˆã§ã¯ã°ã‹ã’ãŸã‚‚ã®ã§ã™ã€‚**

### ç¬¬å››ã®ã€Œè„†å¼±æ€§ã€

ãªã‚“ã¦ã“ã£ãŸã€ã“ã‚Œã¯ã²ã©ãã†ã§ã™ï¼ **`npm audit` ãŒçœŸã£èµ¤ãªæ–‡å­—ã‚’å‡ºã—ã¦ãã‚„ãŒã‚Šã¾ã—ãŸã‚ˆã€‚**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ High          â”‚ Denial of Service                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Package       â”‚ css-what                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Patched in    â”‚ >=5.0.1                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dependency of â”‚ react-scripts                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Path          â”‚ react-scripts > @svgr/webpack > @svgr/plugin-svgo > svgo >   â”‚
â”‚               â”‚ css-select > css-what                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ More info     â”‚ https://npmjs.com/advisories/1754                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

æ·±åˆ»åº¦ãŒã€Œé«˜ã€ã¨ã¯ã©ã‚“ãªå†…å®¹ãªã‚“ã§ã—ã‚‡ã†ï¼Ÿ ã€ŒDenial of serviceã€ã§ã™ã£ã¦ã€‚è‡ªåˆ†ã®ã‚µãƒ¼ãƒ“ã‚¹ã« DoS æ”»æ’ƒãªã‚“ã¦å‹˜å¼ã§ã™ã‚ˆï¼ãã‚“ãªã®ã²ã©ã™ãã¾ã™â€¦â€¦

ä»¶ã®[issue](https://www.npmjs.com/advisories/1754)ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚è¦‹ã¦ã®é€šã‚Š [`css-what`](https://www.npmjs.com/package/css-what) ã¨ã„ã† CSS ã‚»ãƒ¬ã‚¯ã‚¿ã®ãƒ‘ãƒ¼ã‚µãƒ¼ãŒã€ç‰¹æ®Šãªå…¥åŠ›ã‚’å—ã‘å–ã£ãŸéš›ã«éå¸¸ã«é…ããªã‚‹ã“ã¨ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚ã“ã®ãƒ‘ãƒ¼ã‚µãƒ¼ã¯ SVG ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ React ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‹ã‚‰ä½¿ã‚ã‚Œã¦ã„ã¾ã™ã€‚

ã¨ã„ã†ã“ã¨ã¯ã€ã‚‚ã—æ”»æ’ƒè€…ãŒç§ã®é–‹ç™ºç’°å¢ƒã¾ãŸã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æŒæ¡ã—ãŸå ´åˆã€æ”»æ’ƒç”¨ã«ä½œã‚‰ã‚ŒãŸ CSS ã®ã‚»ãƒ¬ã‚¯ã‚¿ã‚’å«ã‚€ç‰¹æ®Šãª SVG ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»•è¾¼ã‚€ã“ã¨ã§ã€ç§ã®ãƒ“ãƒ«ãƒ‰æ™‚é–“ã‚’é…ãã§ãã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚
ã“ã“ã‹ã‚‰åˆ†ã‹ã‚‹ã‚ˆã†ã«â€¦â€¦

ã£ã¦å¾…ã£ã¦ãã ã•ã„ï¼ï¼Ÿ ã‚‚ã—æ”»æ’ƒè€…ãŒç§ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ã„ã˜ã‚Œã‚‹ã®ã ã¨ã—ãŸã‚‰ã€å¤šåˆ†ä»•è¾¼ã‚“ã§ãã‚‹ã®ã¯ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ã®ãƒã‚¤ãƒŠãƒ¼ã¨ã‹ã ã¨æ€ã„ã¾ã™ã‚ˆã€‚ä½•ã‚’ã©ã†ã—ãŸã‚‰ SVG ã‚’ã‚¢ãƒ—ãƒªå†…ã«å…¥ã‚Œã‚ˆã†ãªã‚“ã¦æ€ã„ã¾ã™ï¼Ÿ SVG ã§ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ã¨ã‹æ˜ã‚Œã‚‹ã‚“ã ã£ãŸã‚‰åˆ¥ã§ã™ã‘ã©ã€‚ãã†ã„ã†ã‚ã‘ã§ã€ã“ã®è©±ã¯ã‚‚ã†*ã¾ã£ãŸã*æ„å‘³ãŒã‚ã‹ã‚Šã¾ã›ã‚“ã­ã€‚

**è©•æ±º: æœ¬ã€Œè„†å¼±æ€§ã€ã¯ã“ã®æ–‡è„ˆã§ã¯ã°ã‹ã’ãŸã‚‚ã®ã§ã™ã€‚**

æ·±åˆ»åº¦ã€Œé«˜ã€ã§ã™ã‚‰ã“ã®ã‚¢ãƒªã‚µãƒã§ã™ã‚ˆï¼

### ç¬¬äº”ã®ã€Œè„†å¼±æ€§ã€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ High          â”‚ Denial of Service                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Package       â”‚ css-what                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Patched in    â”‚ >=5.0.1                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dependency of â”‚ react-scripts                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Path          â”‚ react-scripts > optimize-css-assets-webpack-plugin > cssnano â”‚
â”‚               â”‚ > cssnano-preset-default > postcss-svgo > svgo > css-select  â”‚
â”‚               â”‚ > css-what                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ More info     â”‚ https://npmjs.com/advisories/1754                            â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ã“ã‚Œã¯ã•ã£ãã®ã‚„ã¤ã¨å…¨ãåŒã˜ã§ã™ã€‚

**è©•æ±º: æœ¬ã€Œè„†å¼±æ€§ã€ã¯ã“ã®æ–‡è„ˆã§ã¯ã°ã‹ã’ãŸã‚‚ã®ã§ã™ã€‚**

### ã“ã®è©±ã¾ã ç¶šã‘ã¾ã™ï¼Ÿ


So far the boy has cried wolf five times. Two of them are duplicates. The rest are absurd non-issues in the context of how these dependencies are used.

Five false alarms wouldnâ€™t be too bad.

**Unfortunately, there are hundreds.**

Here are a [few](https://github.com/facebook/create-react-app/issues/11053) [typical](https://github.com/facebook/create-react-app/issues/11092) threads, but there are many more [linked from here](https://github.com/facebook/create-react-app/issues/11174):

<img src="https://imgur.com/ABDK4Ky.png" alt="Screenshot of many GH threads" />

**Iâ€™ve spent several hours looking through every `npm audit` issue reported to us over the last several months, and they all appear to be false positives in the context of a build tool dependency like Create React App.**

Of course, they are possible to fix. We could relax some of the top-level dependencies to not be exact (leading to bugs in patches slipping in more often). We could make more releases just to stay ahead of this security theater.

But this is inadequate. Imagine if your tests failed 99% of the times for bogus reasons! This wastes person-decades of effort and makes everyone miserable:

* **It makes beginners miserable** because they run into this as their first programming experience in the Node.js ecosystem. As if installing Node.js/npm was not confusing enough (good luck if you added `sudo` somewhere because a tutorial told you), this is what theyâ€™re greeted with when they try examples online or even when they create a project. A beginner doesnâ€™t know what a RegExp *is*. Of course they donâ€™t have the know-how to be able to tell whether a RegExp DDoS or prototype pollution is something to worry about when theyâ€™re using a build tool to produce a static HTML+CSS+JS site.
* **It makes experienced app developers miserable** because they have to either waste time doing obviously unnecessary work, or fight with their security departments trying to explain how `npm audit` is a broken tool unsuitable for real security audits _by design_. Yeah, somehow it was made a default in this state.
* **It makes maintainers miserable** because instead of working on bugfixes and improvements, they have to pull in bogus vulnerability fixes that canâ€™t possibly affect their project because otherwise their users are frustrated, scared, or both.
* **Someday, it will make our users miserable** because we have trained an entire generation of developers to either not understand the warnings due to being overwhelmed, or to simply _ignore_ them because they always show up but the experienced developers (correctly) tell them there is no real issue in each case.

It doesnâ€™t help that `npm audit fix` (which the tool suggests using) is buggy. I ran `npm audit fix --force` today and it **downgraded** the main dependency to a three-year-old version with actual _real_ vulnerabilities. Thanks, npm, great job.

## What next?

I donâ€™t know how to solve this. But I didnâ€™t add this system in the first place, so Iâ€™m probably not the best person to solve it. All I know is itâ€™s horribly broken.

There are a few possible solutions that I have seen.

* **Move dependency to `devDependencies` if it doesnâ€™t run in production.** This offers a way to specify that some dependency isnâ€™t used in production code paths, so there is no risk associated with it. However, this solution is flawed:
  - `npm audit` still warns for development dependencies by default. You have to _know_ to run `npm audit --production` to not see the warnings from development dependencies. People who know to do that probably already donâ€™t trust it anyway. This also doesnâ€™t help beginners or people working at companies whose security departments want to audit everything.
  - `npm install` still uses information from plain `npm audit`, so you will effectively still see all the false positives every time you install something.
  - As any security professional will tell you, development dependencies actually _are_ an attack vector, and perhaps one of the most dangerous ones because itâ€™s so hard to detect and the code runs with high trust assumptions. **This is why the situation is so bad in particular: any real issue gets buried below dozens of non-issues that `npm audit` is training people and maintainers to ignore.** Itâ€™s only a matter of time until this happens.
* **Inline all dependencies during publish.** This is what Iâ€™m increasingly seeing packages similar to Create React App do. For example, both [Vite](https://unpkg.com/browse/vite@2.4.1/dist/node/) and [Next.js](https://unpkg.com/browse/next@11.0.1/dist/) simply bundle their dependencies directly in the package instead of relying on the npm `node_modules` mechanism. From a maintainerâ€™s point of view, [the upsides are clear](https://github.com/vitejs/vite/blob/main/.github/contributing.md#notes-on-dependencies): you get faster boot time, smaller downloads, and â€” as a nice bonus â€” no bogus vulnerability reports from your users. Itâ€™s a neat way to game the system but Iâ€™m worried about the incentives npm is creating for the ecosystem. Inlining dependencies kind of goes against the whole point of npm.
* **Offer some way to counter-claim vulnerability reports.** The problem is not entirely unknown to Node.js and npm, of course. Different people have worked on different suggestions to fix it. For example, there is a [proposal](https://github.com/npm/rfcs/pull/18) for a way to manually resolve audit warnings so that they donâ€™t display again. However, this still places the burden on app users, which donâ€™t necessarily have context on what vulnerabilities deeper in the tree are real or bogus. I also have a [proposal](https://twitter.com/dan_abramov/status/1412380714012594178): I need a way to mark for my users that a certain vulnerability canâ€™t possibly affect them. If you donâ€™t trust my judgement, why are you running my code on your computer? Iâ€™d be happy to discuss other options too.

The root of the issue is that npm added a default behavior that, in many situations, leads to a 99%+ false positive rate, creates an incredibly confusing first programming experience, makes people fight with security departments, makes maintainers never want to deal with Node.js ecosystem ever again, and at some point will lead to actually bad vulnerabilities slipping in unnnoticed.

Something has to be done.

In the meantime, I am planning to close all GitHub issues from `npm audit` that I see going forward that donâ€™t correspond to a _real_ vulnerability that can affect the project. I invite other maintainers to adopt the same policy. This will create frustration for our users, but the core of the issue is with npm. I am done with this security theater. Node.js/npm have all the power to fix the problem. I am in contact with them, and I hope to see this problem prioritized.

Today, `npm audit` is broken by design.

Beginners, experienced developers, maintainers, security departments, and, most importantly â€” our users â€” deserve better.
