---
title: Why Do React Elements Have a $$typeof Property?
date: '2018-12-03'
spoiler: It has something to do with security.
cta: 'react'
---

ุญุชูุง ูฺฉุฑ ูโฺฉูุฏ ฺฉู JSX ูโููุณุฏ:

```jsx
<marquee bgcolor="#ffa7c4">hi</marquee>
```

ูู ุฏุฑ ุญููุชุ ฺฉ ุชุงุจุน ุตุฏุง ูโุฒูุฏ:

```jsx
React.createElement(
  /* type */ 'marquee',
  /* props */ { bgcolor: '#ffa7c4' },
  /* children */ 'hi'
)
```

ฺฉู ุขู ุชุงุจู ุจู ุดูุง ฺฉ ุขุจุฌฺฉุช ุจุงุฒ ูโฺฏุฑุฏุงูุฏ. ูุง ุงู ุชุงุจุน ุฑุง *element* ุฑโุงฺฉุช ูโูุงูู. ุงู ุชุงุจุน ุจู ุฑโุงฺฉุช ูโฺฏูุฏ ฺฉู ุฑูุฏุฑ ุจุนุฏ ฺุณุช.  ุชุงุจุน ุดูุง ุฏุฑุฎุช ุงุฒ ุขููุง ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ
```jsx{9}
{
  type: 'marquee',
  props: {
    bgcolor: '#ffa7c4',
    children: 'hi',
  },
  key: null,
  ref: null,
  $$typeof: Symbol.for('react.element'), // ๐ง Who dis
}
```

ุงฺฏุฑ ุงุฒ ุฑโุงฺฉุช ุงุณุชูุงุฏู ูโฺฉูุฏ ุงุญุชูุงูุง ุจุง ููุงูู `type`, `props`, `key`, ู `ref` ุขุดูุง ุฏุงุฑุฏ. **ูู  `$$typeof` ฺุณุช? ู ฺุฑุง ฺฉ  `Symbol()` ุจู ุนููุงู ููุฏุงุฑ ุฏุงุฑุฏ?**

ุงู ฺฉ ุงุฒ ููุงุฑุฏ ุงุณุช ฺฉู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑโุงฺฉุช ุจู ุฏุงูุณุชู ุขู *ูุงุฒ* ูุฏุงุฑุฏุ ูู ููุช ูโุฏุงูุฏ ุจู ุดูุง ุงุญุณุงุณ ุฎูุจ ูโุฏูุฏ. ููฺูู ฺฉโุณุฑ ูฺฉุงุช ุฏุฑ ููุฑุฏ ุงููุช ุฏุฑ ุงู ูพุณุช ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุดุงุฏ ุจุฎูุงูุฏ ุจุฏุงูุฏ. ุดุงุฏ ุฑูุฒ ฺฉุชุงุจุฎุงูู ุฑุงุจุท ฺฉุงุฑุจุฑ ุฎูุฏ ุฑุง ููุดุชุฏ ู ุชูุงู ุงููุง ุจู ุฏุฑุฏุชุงู ุฎูุฑุฏ. ุจู ุดุฎุตู ุงูุฏูุงุฑู.

---

ูุจู ุงุฒ ุงูฺฉู ฺฉุชุงุจุฎุงููโูุง ุณูุช ฺฉุงุฑุจุฑ ุฑุงุฌ ุดูุฏ ู ุญูุงุธุช ูพุงูโุง ุงุถุงูู ฺฉููุฏุ ุจุฑุง ฺฉุฏ ฺฉ ูุฑูโุงูุฒุงุฑ ุฑุงุฌ ุจูุฏ ฺฉู HTML ุฑุง ุจุณุงุฒุฏ ู ุณูพุณ ุจู DOM ูุงุฑุฏ ฺฉูุฏ.

```jsx
const messageEl = document.getElementById('message');
messageEl.innerHTML = '<p>' + message.text + '</p>';
```

ฺฉุฏ ุจุงูุง ูฺ ูุดฺฉู ูุฏุงุฑูุ ุจู ุฌุฒ ุฒูุงู ฺฉู `message.text` ฺุฒ ุดุจู ุจู `'<img src onerror="stealYourPassword()">'` ุจุงุดุฏ. **ุดูุง ููโููุงูุฏ ฺุฒ ฺฉู ุบุฑุจูโูุง ูโููุณูุฏ ุฏุฑ HTML ุฑูุฏุฑ ุดุฏู ูุฑูโุงูุฒุงุฑ ุดูุง ฺฉููู ุจู ฺฉููู ุธุงูุฑ ุดูุฏ.**

(ู ูฺฉุชู ุจุงุญุงู: ุงฺฏุฑ ููุท ุฑูุฏุฑ ุณูุช ฺฉุงุฑุจุฑ ุฏุงุฑุฏ, ฺฉ ุชฺฏ `<script>` ุฏุฑ ุงูุฌุง ุจู ุดูุง ุงุฌุงุฒู ุงุฌุฑุง ุฌุงูุงุงุณฺฉุฑูพุช ููโุฏูุฏ. ูู [ุงุฌุงุฒู ูุฏูุฏ ุงู](https://gomakethings.com/preventing-cross-site-scripting-attacks-when-using-innerhtml-in-vanilla-javascript/) ุดูุงุฑ ู ุจู ุฏุฑฺฉ ุงุดุชุจุงู ุงุฒ ุงููุช ุณูู ุจุฏูุฏ.)

ุจุฑุง ุญูุงุธุช ุงุฒ ฺูู ุญููุงุช, ูโุชูุงูุฏ ุงุฒ APIูุง ูุซู `document.createTextNode()` ุง `textContent` ฺฉู ููุท ุจุง ูุชู ุณุฑูฺฉุงุฑ ุฏุงุฑุฏ ุงุณุชูุงุฏู ฺฉูุฏ. ุดูุงุฑ ูโุชูุงูุฏ ุจุง ุฌุงฺฏุฒู ฺฉุฑุฏู ฺฉุงุฑฺฉุชุฑูุง ูุซู `<`, `>` ุฏุฑ ููุฏโูุง ูุฑูุฏ ฺฉู ุชูุณุท ฺฉุงุจุฑ ูพุฑ ูโุดููุฏ ุงุฒ ุงู ุญููุงุช ูพุดโฺฏุฑ ฺฉูุฏ.
ูููุฒุ ูุฒูู ุงุดุชุจุงู ุฒุงุฏ ุงุณุช ู ูุฑ ุจุงุฑ ุจู ุฎุงุทุฑ ุฏุงุดุชู ุชูุณุฑ ฺฉุฑุฏู ูุชู ุฎุฑูุฌ ฺฉุงุฑุจุฑ ุนุฐุงุจ ุขูุฑ ุงุณุช. **ุจู ููู ุฏูู ุงุณุช ฺฉู ฺฉุชุงุจุฎุงููโูุง ูุฏุฑู ูุงููุฏ React ุจู ุตูุฑุช ูพุด ูุฑุถ ุงุฒ ูุญุชูุง text ุจุฑุง string ูุฑุงุฑ ูโฺฉููุฏ:**

```jsx
<p>
  {message.text}
</p>
```

ุงฺฏุฑ `message.text` ฺฉ ูุชู ุฎุทุฑูุงู ุจุง ุชฺฏ `<img>` ุง ุชฺฉ ุฏฺฏุฑ ุจุงุดุฏ, ุจู ุชฺฏ ูุงูุน `<img>` ุชุจุฏู ููโุดูุฏ. React ุงุฒ ูุญุชูุง ุขู ูฺฏุฐุฑุฏ ุจูุงุจุฑุงู ุจู ุฌุงโุงูฺฉู ุชฺฏ `<img>` ุฑุง ุจุจูุฏ ููุท ูุงุฑฺฉุงูพ ุขู ุฑุง ูโุจูุฏ.

ุจุฑุง ุฑูุฏุฑ ฺฉุฑุฏู HTML ุฏุงุฎู ฺฉุงููููุช ุฑโุงฺฉุช ุจุงุฏ `dangerouslySetInnerHTML={{ __html: message.text }}` ุฑุง ุจููุณุฏ. **ุงู ูฺฉุชู ฺฉู ููุดุชูุด ูุงุดุงูู ุงุณุช ฺฉ ูฺฺฏ ูุญุณูุจ ูโุดูุฏ.** ุฏููุง ุจู ุงู ุนูุช ุฏุฑ ฺุดู ุงุณุช ฺฉู ุฏุฑ ููฺฏุงู ุจุงุฒุญูุงู ฺฉุฏ ู ููุฒโูุง ูพุงฺฏุงู ฺฉูุฏ ุดูุงุณุง ุดูุฏ.

---

**ุขุง ุจู ุงู ูุนูุณุช ฺฉูู ุฑโุงฺฉุช ุงุฒ ุญููุงุงุช ุชุฒุฑู ฺฉุงููุง ุฏุฑ ุงูุงู ุงุณุช? ุฎุฑ.** HTML ู DOM [ุชุนุฏุง ุงุฒ ูุฑูโูุง ุญููู ุฑุง](https://github.com/facebook/react/issues/3473#issuecomment-90594748) ูพุดููุงุฏ ูโุฏููุฏ ฺฉู ุงฺฏุฑ ุฑโุงฺฉุช ุง ุณุงุฑ ฺฉุชุงุจุฎุงููโูุง ุจุฎูุงููุฏ ุจุง ุขููุง ููุงุจูู ฺฉููุฏุง ุจุณุงุฑ ุฏุดูุงุฑ ุงุณุช ุง ุณุฑุนุชุดุงู ุฑุง ฺฉุงูุด ูโุฏูุฏ. ุจุดุชุฑ ุจุฑุฏุงุฑโูุง ุญููู ุจุงู ูุงูุฏู ุฎุตุตูโูุง ุฑุง ุฏุฑุจุฑ ูโฺฏุฑูุฏ.
 ุจุฑุง ูุซุงู ุงฺฏุฑ `<a href={user.website}>` ุฑุง ุฑูุฏุฑ ฺฉูุฏ,ุงุฒ ุขู ุฏุณุชู ุงุฒ ฺฉุงุฑุจุฑุงู ฺฉู ูุจโุณุงุชุดุงู `'javascript: stealYourPassword()'` ุงุณุช ุขฺฏุงู ุจุงุดุฏ. ุงูุชูุงู ุจู ุดฺฉู (...) ุจุฑุง ุฏุงุฏูโูุง ฺฉุงุฑุจุฑ ูุงููุฏ `<div {...userData}>` ูู ูโุชูุงูุฏ ุฎุทุฑูุงฺฉ ุจุงุดุฏ ูู ูุงุฏุฑ ุงุณุช.

ุฑโุงฺฉุช [ูโุชูุงูุฏ](https://github.com/facebook/react/issues/10506) ุฏุฑ ุทูู ุฒูุงู ุญูุงุธุช ุจุดุชุฑ ุฑุง ูุฑุงูู ฺฉูุฏ ูู ุจุดุชุฑ ููุงุฑุฏ ุงู ูุณูู ูุดฺฉู ุณุฑูุฑ ุจู ุญุณุงุจ ูโุขุฏ ฺฉู [ุจุงุฏ](https://github.com/facebook/react/issues/3473#issuecomment-91327040) ุฏุฑ ูุฑ ุตูุฑุช ุจุฑุทุฑู ฺฏุฑุฏุฏ.

ูููุฒุ ุฌููฺฏุฑ ุงุฒ ูุงุฑุฏ ฺฉุฑุฏู ูุญุชูุง ูุชู ุฏุฑ ูุฏู ุงูู ูโุชูุงูุฏ ุจุณุงุฑ ุงุฒ ุญููุงุช ุจุงูููู ุฑุง ฺฉุงูุด ุฏูุฏ. ุฎูุจ ูุณุช ฺฉู ุจุฏููู ฺูู ฺฉุฏูุง ุงูู ูุณุชูุฏ ุง ูู ุ

```jsx
// Escaped automatically
<p>
  {message.text}
</p>
```

**ุฎุจ, ููุดู ูู ุฌูุงุจ ูุซุจุช ูุณุช.**  ุจู ููู ุนูุช ุงุณุช ฺฉู `$$typeof` ูุงุฑุฏ ูุฏุงู ูโุดูุฏ.

---

ุงูููุชโูุง ุฑโุงฺฉุช ุจู ุดฺฉู ุขุจุฌฺฉุช ุฏุฒุงู ุดุฏูโุงูุฏ:

```jsx
{
  type: 'marquee',
  props: {
    bgcolor: '#ffa7c4',
    children: 'hi',
  },
  key: null,
  ref: null,
  $$typeof: Symbol.for('react.element'),
}
```

ุฏุฑ ุญุงู ฺฉู ุดูุง ุจู ุดฺฉู ูุฑูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ `React.createElement()` ุงุฌุงุฏุดุงู ูโฺฉูุฏุ ูุงุฒ ุจู ุงู ุชุงุจุน ูุฏุงุฑุฏ.
ููุงุฑุฏ ุตุงุฏู ุฏุฑ ุฑโุงฺฉุช ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุงุฒ ุขุจุฌฺฉุชโูุง ุณุงุฏู ูพุดุชุจุงู ูโฺฉูุฏ ุฏุฑุณุช ูุซู ฺุฒ ฺฉู ุฏุฑ ุจุงูุง ุงูุฌุงู ุฏุงุฏู. ุงูุจุชู ุดูุง ููโุฎูุงูุฏ ฺฉู ุขููุง ุฑุง ุงูฺฏ.ูู ุจููุณุฏ - ูู [ุงู ูุชูุงูุฏ](https://github.com/facebook/react/pull/3583#issuecomment-90296667) ุจุฑุง ุจูุจูุฏ ฺฉุงููพุงูุฑุ ุงุฑุณุงู (ูพุงุณ ุฏุงุฏู) ุงููุชโูุง ุจู ูุฑฺฉุฑโูุง ุง ุฌุฏุง ฺฉุฑุฏู JSX ุงุฒ ูพฺฉุฌ ุฑโุงฺฉุช ููุฏ ุจุงุดุฏ.

ฺฏุฑฺู, **ุณุฑูุฑ ุณูุฑุงุฎ ุฏุงุฑุฏ ฺฉู ุจู ฺฉุงุฑุจุฑ ุงุฌุงุฒู ูุฏูุฏ ูุฑ ุขุจุฌฺฉุช ุฑุง ุจู ุดฺฉู ุฎูุฏุณุฑุงูู ุฐุฎุฑู ฺฉูุฏ** ุฏุฑ ุญุงู ฺฉู ุณูุช ฺฉุงุฑุจุฑ ููุท ุจู ุฑุดุชู ูุงุฒ ุฏุงุฑุฏ ูุชูุงูุฏ ูุดฺฉู ุงุฌุงุฏ ฺฉูุฏ:

```jsx{2-10,15}
// Server could have a hole that lets user store JSON
let expectedTextButGotJSON = {
  type: 'div',
  props: {
    dangerouslySetInnerHTML: {
      __html: '/* put your exploit here */'
    },
  },
  // ...
};
let message = { text: expectedTextButGotJSON };

// Dangerous in React 0.13
<p>
  {message.text}
</p>
```

ุฏุฑ ุงู ููุฑุฏ ุฑโุงฺฉุช ฐ.ฑณ ูุชูุงูุฏ ูุณุจุช ุจู ุญููุงุช XSS [ุจ ุฏูุงุน](http://danlec.com/blog/xss-via-a-spoofed-react-element) ุจุงุดุฏ. ุจุฑุง ุดูุงูุช ุฏูุจุงุฑูุ **tุงู ุญููุงุช ูุงุฒ ุจุณุชฺฏ ุจู ุณูุฑุงุฎ ุฏุฑ ุณุฑูุฑ ุฏุงุฑุฏ**. ูููุฒ, ุฑโุงฺฉุช ูโุชูุงูุฏ ฺฉุงุฑูุง ุจูุชุฑ ุจุฑุง ุญูุงุธุช ุนูู ุงู ุญููุงุช ุงูุฌุงู ุฏูุฏ. ู ุจุง ุดุฑูุน ุฑโุงฺฉุช ฐ.ฑด ,ุงู ฺฉุงุฑ ุฑุง ูโฺฉูุฏ.

ุงู ุชุนูุฑ ฺฉู ุฏุฑ ุฑโุงูุช ฐ.ฑด ุงูุฌุงู ุดุฏ ุงู ุจูุฏ ฺฉู [ุชูุงู ุงููุงู ูุง ุฑโุงฺฉุช ุฑุง ุจุง ฺฉ ูุดุงู(Symbol) ูุดุงูู ฺฏุฐุงุฑ ฺฉูู](https://github.com/facebook/react/pull/4832):

```jsx{9}
{
  type: 'marquee',
  props: {
    bgcolor: '#ffa7c4',
    children: 'hi',
  },
  key: null,
  ref: null,
  $$typeof: Symbol.for('react.element'),
}
```

ุงู ฺฉุงุฑ ุนููุณุช ฺูู ุดูุง ููโุชูุงูุฏ ุจู ุฑุงุญุช `Symbol` ุฏุฑ JSON ูุฑุงุฑ ุฏูุฏ.**ุจูุงุจุฑุงู ุญุช ุงฺฏุฑ ุณุฑูุฑ ุณูุฑุงุฎ ุฏุงุดุชู ุจุงุดุฏ ู ุจู ุฌุง ุฑุดุชู JSON ุจุฑฺฏุฑุฏุงูุฏ ุขู JSON ููโุชูุงูุฏ `Symbol.for('react.element')` ุฏุงุดุชู ุจุงุดุฏ.** ุฑโุงฺฉุช `element.$$typeof` ุฑุง ฺฺฉ ูโฺฉูุฏุ ู ุงฺฏุฑ ุงู ูุดุงู ุฑุง ูุฏุงุดุชู ุจุงุดุฏ ุงุฒ ูพุฑุฏุงุฒุด ุขู ุฎูุฏุฏุงุฑ ูโฺฉูุฏ.

ฺุฒ ุฎูุจ ฺฉู ุฏุฑ ููุฑุฏ ุฎุตูุตุง`Symbol.for()` ูุฌูุฏ ุฏุงุฑุฏ ุงู ุงุณุช ฺฉู **Symbolูุง ุฏุฑ ุจู ูุญุท ูุซู iframes ู workers ฺฏููุจุงู ูุณุชูุฏ.** ุจูุงุจุฑุงู ุงู ุชุนูุฑ ุงุฒ ุงุฑุณุงู ุงูููุชโูุง ููุฑุฏ ุงุนุชูุงุฏ ุจู ูุณูุชโูุง ูุฎุชูู ูุฑูโุงูุฒุงุฑ ุญุช ุฏุฑ ุดุฑุงุท ุณุฎุช ุฌููฺฏุฑ ููโฺฉูุฏ. ูุดุงุจูุงุ ุญุช ุงฺฏุฑ ฺูุฏู ฺฉูพ ุงุฒ ุฑโุงฺฉุช ุฏุฑ ฺฉ ูพุฌ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ููู ุขููุง ูุณุจุช ุจู ููุฏุงุฑ ุตุญุญ `$$typeof` ูุชูู ุงูููู ูุณุชูุฏ.

---

ุฏุฑ ููุฑุฏ ูุฑูุฑฺฏุฑ ฺฉู ุงุฒ Symbolูุง [ูพุดุชุจุงู ููโฺฉูุฏ](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol#Browser_compatibility) ฺู?

ุงูุณูุณ,ุขููุง ุงุฒ ุงู ุญูุงุธุช ุจูุฑููุฏ ููโุดููุฏ. ุฑโุงฺฉุช ููฺูุงู ููุฏ `$$typeof` ุฏุฑ ุงููุงู ูฺฏู ูโุฏุงุฑุฏ, ูู [ุจู ุนููุงู ุนุฏุฏ](https://github.com/facebook/react/blob/8482cbe22d1a421b73db602e1f470c632b09f693/packages/shared/ReactSymbols.js#L14-L16) โ `0xeac7`.

ฺุฑุง ุงู ุนุฏุฏุ  `0xeac7` ฺ.ู ุดุจู ุจู โReactโ ุงุณุช.
